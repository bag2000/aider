# Dangerous Areas Checklist

Использовать перед:
- запуском скрипта,
- применением изменений,
- деплоем,
- выполнением в production.

Если на любой пункт ответ «не уверен» — остановиться и проверить.

---

## 1. Права и пользователь

- [ ] Под каким пользователем выполняется код/скрипт?
- [ ] Нужен ли root на самом деле?
- [ ] Нет ли лишних прав у файлов/директорий?
- [ ] Понимаю ли я, что изменится при запуске от root?

## 2. Окружение

- [ ] Это точно нужное окружение? (prod / stage / dev)
- [ ] Явно ли указано окружение, а не определяется «по умолчанию»?
- [ ] Нет ли зависимости от случайных переменных окружения?

## 3. Пути и файлы

- [ ] Пути не пустые и не `/`?
- [ ] Нет ли динамически формируемых путей без проверок?
- [ ] Проверяется ли существование файлов/директорий?
- [ ] Нет ли операций записи поверх существующих данных?

## 4. Удаление и перезапись данных

- [ ] Есть ли команды `rm`, `mv`, `truncate`, `dd`, `mkfs`?
- [ ] Проверяется ли цель перед выполнением?
- [ ] Есть ли dry-run или защита от пустых значений?
- [ ] Есть ли резервная копия?

## 5. Сервисы и процессы

- [ ] Есть ли `systemctl restart/stop`?
- [ ] Понимаю ли я влияние на пользователей/прод?
- [ ] Проверяется ли статус сервиса после изменений?
- [ ] Нет ли рестарта «на всякий случай»?
- [ ] Нужно ли временно отключить алертинг/мониторинг перед этим действием?

## 6. Сеть и удалённые системы

- [ ] Понятно ли, куда именно идёт соединение?
- [ ] Есть ли таймауты?
- [ ] Что будет, если удалённая сторона недоступна?
- [ ] Нет ли отправки чувствительных данных?

## 7. Секреты и креды

- [ ] Нет ли паролей / токенов в коде или логах?
- [ ] Файлы с секретами защищены правами?
- [ ] Не выводятся ли секреты в stdout/stderr?
- [ ] Не попадут ли они в CI / логи / history?

## 8. Ошибки и исключения

- [ ] Что произойдёт при ошибке?
- [ ] Скрипт корректно завершится или продолжит выполнение?
- [ ] Ошибка будет заметна или «проглочена»?
- [ ] Понятно ли сообщение об ошибке?

## 9. Идемпотентность

- [ ] Безопасно ли запускать это повторно?
- [ ] Не приведёт ли повторный запуск к поломке?
- [ ] Есть ли проверки «уже сделано»?

## 10. Внешние зависимости

- [ ] Все утилиты/библиотеки гарантированно присутствуют?
- [ ] Проверяется ли их наличие?
- [ ] Нет ли зависимости от версии?

## 11. Логи и вывод

- [ ] Понятно ли по логам, что происходит?
- [ ] Ошибки идут в stderr?
- [ ] Не слишком ли много «мусорного» вывода?
- [ ] Не переполнит ли вывод скрипта диск, если запустить его в verbose-режиме?

## 12. Тайминги и блокировки

- [ ] Есть ли долгие операции?
- [ ] Возможны ли зависания?
- [ ] Есть ли таймауты / лимиты ожидания?

## 13. Обратимость изменений

- [ ] Можно ли откатить изменения?
- [ ] Понятно ли, как вернуть систему в исходное состояние?
- [ ] Зафиксированы ли изменения (что и где меняется)?

## 14. Контекст выполнения

- [ ] Это точно нужный хост?
- [ ] Это точно нужная директория?
- [ ] Это точно нужная версия скрипта?

## 15. Последний вопрос

- [ ] Я готов выполнить это **прямо сейчас в проде**?

## Self-Check After Solution

После генерации любого решения (код, скрипт, конфигурация, команды):

1. Проведи **внутреннюю самопроверку** по `Dangerous Areas Checklist`.
2. Если какие-либо пункты чек-листа:
   - потенциально затронуты,
   - зависят от окружения,
   - могут быть опасны при неверном применении,

   **явно укажи их пользователю**.

3. Формат указания:
   - перечисли номера и названия пунктов чек-листа,
   - кратко опиши риск,
   - укажи, что именно пользователь должен проверить перед применением.

4. Не повторяй весь чек-лист.
   Указывай **только релевантные пункты**.

5. Если решение безопасно при стандартных условиях —
   явно напиши, что **критичных пунктов не выявлено**.

Цель: помочь пользователю осознанно принять решение перед применением,
а не просто выполнить сгенерированный код.
